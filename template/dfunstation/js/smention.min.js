(function(e){function r(t,n,r){qlist="";e.each(t,function(e,t){whb=e%2==0?"dark":"";if(n["after"]){t.id+=n["after"]}qlist+="<div id='"+t.id+"' class='sitem "+whb+"' title='"+t.name+"'>";if(n.avatar==true){qlist+="<img class='avatar' height='24' width='24' src='"+t.avatar+"'/>"}qlist+="<span class='name'>"+t.name+"</span>";qlist+="</div>"});e(".sm_conts").html(qlist);i(n,r)}function i(t,n){if(t.width!=undefined){e(".sm_bar").width(t.width)}e(".sm_bar").data("from",n);e(".sm_bar").css("left",n.offset().left);if(t.position=="below"){e(".sm_bar").css("top",parseFloat(n.offset().top)+n.outerHeight())}else{e(".sm_bar").css("top",parseFloat(n.offset().top)-e(".sm_bar").height())}e(".sm_bar").show()}e.fn.smention=function(n,r){if(e(".sm_bar").length==0){e("body").append("<div class='sm_bar'><div class='sm_conts'></div><div class='sm_close'></div></div>")}if(typeof r.cache==="undefined"){r.cache=true}localStorage["smlto"]="";localStorage["smloc"]="";lc=0;var i=[];return this.each(function(){e(this).on("keydown",function(e){if(e.keyCode==16||e.keyCode==50){i[e.keyCode]=true}});e(this).on("keyup",function(s){t=e(this);if(i[50]&&i[16]){lc=t[0].selectionStart-1;t.data("callNow","enabled");t.enSmen(n,r)}localStorage["smlto"]=t.val().substring(lc).split(/\(|\)|\*| /)[0];localStorage["smloc"]=parseFloat(lc)+","+(parseFloat(lc)+localStorage["smlto"].length);if(parseFloat(lc)+localStorage["smlto"].length<t[0].selectionStart||localStorage["smlto"]==""){t.unSmen()}if(s.keyCode==16||s.keyCode==50){i[s.keyCode]=false}})})};var n={};e.fn.enSmen=function(i,s){return this.each(function(){if(e(this).data("squed")==undefined){e(this).data("squed",1);e(this).bind("keyup",function(o){t=e(this);smlto=localStorage["smlto"].replace("@","");if(typeof s.extraParams=="object"){data=e.extend({q:smlto},s.extraParams)}else{data={q:smlto}}if(e(this).data("callNow")!="disabled"&&o.keyCode!=16&&data.q!=""){if(n[smlto]&&s.cache===true){r(n[smlto],s,t)}e.post(i,data,function(e){if(!n[smlto]&&s.cache===true){r(e,s,t)}if(s.cache===true){n[smlto]=e}else{r(e,s,t)}},"JSON")}})}})};e.fn.unSmen=function(){return this.each(function(){e(this).data("callNow","disabled");e(".sm_bar").hide()})}})(jQuery);String.prototype.replaceBetween=function(e,t,n){return this.substring(0,e)+n+this.substring(t)};$(document).ready(function(){$("body").on("click",".sm_bar .sitem",function(){var e=$(this).attr("id");parts=localStorage["smloc"].split(",");start=parseFloat(parts[0])+1;end=parts[1];t=$(".sm_bar").data("from");t.val(t.val().replaceBetween(start,end,e));$(".sm_bar").hide();t.focus()})});
